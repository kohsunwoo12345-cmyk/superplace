<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPT ì œì‘ í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        label {
            display: block;
            margin: 20px 0 8px;
            font-weight: bold;
            color: #333;
        }
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        textarea {
            min-height: 300px;
            font-family: 'Courier New', monospace;
        }
        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .info {
            background: #f0f7ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .info strong {
            color: #667eea;
        }
        .preview {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .preview-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .preview-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š PPT ìë™ ì œì‘ í…ŒìŠ¤íŠ¸</h1>
        <p class="subtitle">Superplace Study ì‹œìŠ¤í…œ ì†Œê°œ PPT</p>

        <div class="info">
            <strong>ğŸ’¡ í…ŒìŠ¤íŠ¸ ë°©ë²•:</strong><br>
            1. ì•„ë˜ ì œëª©, í˜ì´ì§€ ìˆ˜, ë‚´ìš©ì´ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤<br>
            2. "PPT ìƒì„±í•˜ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”<br>
            3. ì ì‹œ í›„ ìë™ìœ¼ë¡œ .pptx íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤<br>
            4. PowerPointì—ì„œ íŒŒì¼ì„ ì—´ì–´ì„œ í™•ì¸í•˜ì„¸ìš”
        </div>

        <label for="title">PPT ì œëª©</label>
        <input type="text" id="title" value="Superplace Study - ìŠ¤ë§ˆíŠ¸ í•™ì› ê´€ë¦¬ ì‹œìŠ¤í…œ">

        <label for="pageCount">í˜ì´ì§€ ìˆ˜</label>
        <input type="number" id="pageCount" value="10" min="1" max="20">

        <label for="content">ë‚´ìš© (í•œ ì¤„ì— í•˜ë‚˜ì”©)</label>
        <textarea id="content">í•™ì› ìš´ì˜ì˜ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ë¡œ í†µí•©í•œ í”Œë«í¼
í•™ìƒ, í•™ë¶€ëª¨, êµì‚¬ë¥¼ ìœ„í•œ ì˜¬ì¸ì› ì†”ë£¨ì…˜
ì‹¤ì‹œê°„ í•™ìŠµ ê´€ë¦¬ ë° ì„±ê³¼ ì¶”ì 
AI ê¸°ë°˜ ë§ì¶¤í˜• í•™ìŠµ ì§€ì›
ê°„í¸í•œ ì¶œì„ ì²´í¬ ë° ê´€ë¦¬ ì‹œìŠ¤í…œ
í•™ë¶€ëª¨ì™€ì˜ íš¨ê³¼ì ì¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë„êµ¬
ìë™í™”ëœ ë¬¸ì ë°œì†¡ ê¸°ëŠ¥
ëœë”©í˜ì´ì§€ ì œì‘ìœ¼ë¡œ ë§ˆì¼€íŒ… ê°•í™”
í´ë¼ìš°ë“œ ê¸°ë°˜ìœ¼ë¡œ ì–¸ì œ ì–´ë””ì„œë‚˜ ì ‘ì† ê°€ëŠ¥
ëª¨ë°”ì¼ ì¹œí™”ì ì¸ ë°˜ì‘í˜• ë””ìì¸
í•™ìƒ ì„±ì  ë° í•™ìŠµ ì´ë ¥ í†µí•© ê´€ë¦¬
ìˆ™ì œ ì œì¶œ ë° í”¼ë“œë°± ì‹œìŠ¤í…œ
AI ì±—ë´‡ì„ í™œìš©í•œ 24ì‹œê°„ ìƒë‹´ ì„œë¹„ìŠ¤
í•™ì›ë³„ ë§ì¶¤ ëŒ€ì‹œë³´ë“œ ì œê³µ
ë³´ì•ˆì´ ê°•í™”ëœ ë°ì´í„° ê´€ë¦¬
ì‹¤ì‹œê°„ ë¶„ì„ ë° ë¦¬í¬íŠ¸ ìƒì„±
ë‹¤ì–‘í•œ ê²°ì œ ë°©ì‹ ì§€ì›
í•™ìƒ ê°œì¸ë³„ í•™ìŠµ ì§„ë„ ì¶”ì 
êµì‚¬ ì—…ë¬´ íš¨ìœ¨ì„± ê·¹ëŒ€í™”
í•™ì› ìš´ì˜ ë¹„ìš© ì ˆê° íš¨ê³¼
ì§ê´€ì ì´ê³  ì‚¬ìš©í•˜ê¸° ì‰¬ìš´ ì¸í„°í˜ì´ìŠ¤
ì§€ì†ì ì¸ ì—…ë°ì´íŠ¸ ë° ê¸°ìˆ  ì§€ì›
í•™ì› ë¸Œëœë”©ì„ ìœ„í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì˜µì…˜
ë°ì´í„° ë°±ì—… ë° ë³µêµ¬ ì‹œìŠ¤í…œ
í•™ë¶€ëª¨ ë§Œì¡±ë„ í–¥ìƒ
í•™ìƒ í•™ìŠµ ë™ê¸° ë¶€ì—¬ ê°•í™”
êµìœ¡ í’ˆì§ˆ ê°œì„ 
ê²½ìŸë ¥ ìˆëŠ” ê°€ê²© ì •ì±…
ë¬´ë£Œ ì²´í—˜ ë° ë°ëª¨ ì œê³µ
ì „ë‹´ ê³ ê° ì§€ì›íŒ€ ìš´ì˜</textarea>

        <div class="preview">
            <div class="preview-item">
                <span>ì…ë ¥í•œ í•­ëª©:</span>
                <strong id="lineCount">30ê°œ</strong>
            </div>
            <div class="preview-item">
                <span>ìƒì„±ë  ìŠ¬ë¼ì´ë“œ:</span>
                <strong id="slideCount">11ì¥ (ì œëª© í¬í•¨)</strong>
            </div>
            <div class="preview-item">
                <span>í˜ì´ì§€ë‹¹ í‰ê·  í•­ëª©:</span>
                <strong id="itemsPerPage">3ê°œ</strong>
            </div>
        </div>

        <button onclick="createPPT()">ğŸ“Š PPT ìƒì„±í•˜ê¸°</button>
    </div>

    <script>
        // ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updatePreview() {
            const content = document.getElementById('content').value;
            const pageCount = parseInt(document.getElementById('pageCount').value) || 1;
            const lines = content.split('\n').filter(l => l.trim());
            
            document.getElementById('lineCount').textContent = lines.length + 'ê°œ';
            document.getElementById('slideCount').textContent = (pageCount + 1) + 'ì¥ (ì œëª© í¬í•¨)';
            document.getElementById('itemsPerPage').textContent = Math.ceil(lines.length / pageCount) + 'ê°œ';
        }

        document.getElementById('content').addEventListener('input', updatePreview);
        document.getElementById('pageCount').addEventListener('input', updatePreview);

        // PPT ìƒì„± í•¨ìˆ˜
        function createPPT() {
            const title = document.getElementById('title').value.trim();
            const pageCount = parseInt(document.getElementById('pageCount').value) || 1;
            const content = document.getElementById('content').value.trim();

            if (!title) {
                alert('ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            if (!content) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            console.log('ğŸ“¤ Creating PPT:', { title, pageCount });

            // ë‚´ìš©ì„ í˜ì´ì§€ ìˆ˜ì— ë§ê²Œ ë¶„í• 
            const lines = content.split('\n').filter(line => line.trim());
            const linesPerPage = Math.ceil(lines.length / pageCount);
            
            const slides = [];
            for (let i = 0; i < pageCount; i++) {
                const startIdx = i * linesPerPage;
                const endIdx = Math.min(startIdx + linesPerPage, lines.length);
                const pageLines = lines.slice(startIdx, endIdx);
                
                if (pageLines.length > 0) {
                    slides.push({
                        title: `${title} - ${i + 1}`,
                        content: pageLines.join('\n')
                    });
                }
            }

            console.log('ğŸ“„ Generated slides:', slides.length);

            // PPT ìƒì„±
            const pptx = new PptxGenJS();
            
            pptx.author = 'Superplace Study';
            pptx.company = 'Superplace';
            pptx.title = title;

            // ì²« ìŠ¬ë¼ì´ë“œ (ì œëª©)
            const titleSlide = pptx.addSlide();
            titleSlide.background = { color: 'FFFFFF' };
            titleSlide.addText(title, {
                x: 1,
                y: 2.5,
                w: 8,
                h: 1.5,
                fontSize: 44,
                bold: true,
                color: '363636',
                align: 'center'
            });
            titleSlide.addText(`ì´ ${slides.length}ê°œ ìŠ¬ë¼ì´ë“œ`, {
                x: 1,
                y: 4,
                w: 8,
                h: 0.5,
                fontSize: 20,
                color: '666666',
                align: 'center'
            });

            // ê° ë‚´ìš© ìŠ¬ë¼ì´ë“œ
            slides.forEach((slideData, index) => {
                const slide = pptx.addSlide();
                slide.background = { color: 'FFFFFF' };
                
                // ì œëª©
                slide.addText(slideData.title, {
                    x: 0.5,
                    y: 0.5,
                    w: 9,
                    h: 0.8,
                    fontSize: 28,
                    bold: true,
                    color: '363636',
                    align: 'center'
                });
                
                // ë‚´ìš©
                const contentLines = slideData.content.split('\n').filter(line => line.trim());
                slide.addText(contentLines, {
                    x: 1,
                    y: 2,
                    w: 8,
                    h: 4.5,
                    fontSize: 16,
                    color: '555555',
                    align: 'left',
                    valign: 'top',
                    bullet: true
                });
                
                // ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸
                slide.addText(`${index + 1} / ${slides.length}`, {
                    x: 8.5,
                    y: 7,
                    w: 1,
                    h: 0.3,
                    fontSize: 12,
                    color: '999999',
                    align: 'right'
                });
            });

            console.log('âœ… PPT ê°ì²´ ìƒì„± ì™„ë£Œ');

            // íŒŒì¼ëª… ìƒì„±
            const filename = `${title.replace(/[^a-zA-Z0-9ê°€-í£]/g, '_')}_${Date.now()}.pptx`;

            // PPT ë‹¤ìš´ë¡œë“œ
            pptx.writeFile({ fileName: filename }).then(() => {
                console.log('âœ… PPT íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ:', filename);
                alert(`âœ… PPTê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\níŒŒì¼ëª…: ${filename}\nìŠ¬ë¼ì´ë“œ ìˆ˜: ${slides.length + 1}ê°œ (ì œëª© í¬í•¨)\n\nDownloads í´ë”ë¥¼ í™•ì¸í•˜ì„¸ìš”!`);
            }).catch(error => {
                console.error('âŒ Failed to create PPT:', error);
                alert('PPT ìƒì„± ì‹¤íŒ¨: ' + error.message);
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        updatePreview();
    </script>
</body>
</html>
