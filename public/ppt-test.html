<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPT ì œì‘ í…ŒìŠ¤íŠ¸ - Superplace Study</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }
        .info-box {
            background: #f0f7ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .info-box strong {
            color: #667eea;
            display: block;
            margin-bottom: 10px;
        }
        .form-group {
            margin: 25px 0;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        input, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        textarea {
            min-height: 300px;
            font-family: 'Courier New', monospace;
            resize: vertical;
        }
        .preview-box {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .preview-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .preview-row:last-child {
            border-bottom: none;
        }
        .preview-label {
            color: #666;
        }
        .preview-value {
            font-weight: 600;
            color: #333;
        }
        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        .btn:active:not(:disabled) {
            transform: translateY(0);
        }
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .status {
            text-align: center;
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: 500;
        }
        .status.loading {
            background: #fff3cd;
            color: #856404;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š PPT ìë™ ì œì‘ í…ŒìŠ¤íŠ¸</h1>
        <p class="subtitle">Superplace Study ì‹œìŠ¤í…œ ì†Œê°œ í”„ë ˆì  í…Œì´ì…˜</p>

        <div class="info-box">
            <strong>ğŸ’¡ í…ŒìŠ¤íŠ¸ ë°©ë²•</strong>
            <ol style="margin-left: 20px; line-height: 1.8;">
                <li>ì•„ë˜ ë‚´ìš©ì´ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤</li>
                <li><strong>"ğŸ“Š PPT ìƒì„±í•˜ê¸°"</strong> ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</li>
                <li>ì ì‹œ í›„ .pptx íŒŒì¼ì´ ìë™ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤</li>
                <li>PowerPointì—ì„œ íŒŒì¼ì„ ì—´ì–´ í™•ì¸í•˜ì„¸ìš”</li>
            </ol>
        </div>

        <div class="form-group">
            <label for="title">ğŸ“Œ PPT ì œëª©</label>
            <input type="text" id="title" value="Superplace Study - ìŠ¤ë§ˆíŠ¸ í•™ì› ê´€ë¦¬ ì‹œìŠ¤í…œ">
        </div>

        <div class="form-group">
            <label for="pageCount">ğŸ“„ í˜ì´ì§€ ìˆ˜ (1-20)</label>
            <input type="number" id="pageCount" value="10" min="1" max="20">
        </div>

        <div class="form-group">
            <label for="content">ğŸ“ ë‚´ìš© (í•œ ì¤„ì— í•˜ë‚˜ì”©)</label>
            <textarea id="content">í•™ì› ìš´ì˜ì˜ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ë¡œ í†µí•©í•œ í”Œë«í¼
í•™ìƒ, í•™ë¶€ëª¨, êµì‚¬ë¥¼ ìœ„í•œ ì˜¬ì¸ì› ì†”ë£¨ì…˜
ì‹¤ì‹œê°„ í•™ìŠµ ê´€ë¦¬ ë° ì„±ê³¼ ì¶”ì 
AI ê¸°ë°˜ ë§ì¶¤í˜• í•™ìŠµ ì§€ì›
ê°„í¸í•œ ì¶œì„ ì²´í¬ ë° ê´€ë¦¬ ì‹œìŠ¤í…œ
í•™ë¶€ëª¨ì™€ì˜ íš¨ê³¼ì ì¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë„êµ¬
ìë™í™”ëœ ë¬¸ì ë°œì†¡ ê¸°ëŠ¥
ëœë”©í˜ì´ì§€ ì œì‘ìœ¼ë¡œ ë§ˆì¼€íŒ… ê°•í™”
í´ë¼ìš°ë“œ ê¸°ë°˜ìœ¼ë¡œ ì–¸ì œ ì–´ë””ì„œë‚˜ ì ‘ì† ê°€ëŠ¥
ëª¨ë°”ì¼ ì¹œí™”ì ì¸ ë°˜ì‘í˜• ë””ìì¸
í•™ìƒ ì„±ì  ë° í•™ìŠµ ì´ë ¥ í†µí•© ê´€ë¦¬
ìˆ™ì œ ì œì¶œ ë° í”¼ë“œë°± ì‹œìŠ¤í…œ
AI ì±—ë´‡ì„ í™œìš©í•œ 24ì‹œê°„ ìƒë‹´ ì„œë¹„ìŠ¤
í•™ì›ë³„ ë§ì¶¤ ëŒ€ì‹œë³´ë“œ ì œê³µ
ë³´ì•ˆì´ ê°•í™”ëœ ë°ì´í„° ê´€ë¦¬
ì‹¤ì‹œê°„ ë¶„ì„ ë° ë¦¬í¬íŠ¸ ìƒì„±
ë‹¤ì–‘í•œ ê²°ì œ ë°©ì‹ ì§€ì›
í•™ìƒ ê°œì¸ë³„ í•™ìŠµ ì§„ë„ ì¶”ì 
êµì‚¬ ì—…ë¬´ íš¨ìœ¨ì„± ê·¹ëŒ€í™”
í•™ì› ìš´ì˜ ë¹„ìš© ì ˆê° íš¨ê³¼
ì§ê´€ì ì´ê³  ì‚¬ìš©í•˜ê¸° ì‰¬ìš´ ì¸í„°í˜ì´ìŠ¤
ì§€ì†ì ì¸ ì—…ë°ì´íŠ¸ ë° ê¸°ìˆ  ì§€ì›
í•™ì› ë¸Œëœë”©ì„ ìœ„í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì˜µì…˜
ë°ì´í„° ë°±ì—… ë° ë³µêµ¬ ì‹œìŠ¤í…œ
í•™ë¶€ëª¨ ë§Œì¡±ë„ í–¥ìƒ
í•™ìƒ í•™ìŠµ ë™ê¸° ë¶€ì—¬ ê°•í™”
êµìœ¡ í’ˆì§ˆ ê°œì„ 
ê²½ìŸë ¥ ìˆëŠ” ê°€ê²© ì •ì±…
ë¬´ë£Œ ì²´í—˜ ë° ë°ëª¨ ì œê³µ
ì „ë‹´ ê³ ê° ì§€ì›íŒ€ ìš´ì˜</textarea>
        </div>

        <div class="preview-box">
            <div class="preview-row">
                <span class="preview-label">ì…ë ¥í•œ í•­ëª©:</span>
                <span class="preview-value" id="lineCount">-</span>
            </div>
            <div class="preview-row">
                <span class="preview-label">ìƒì„±ë  ìŠ¬ë¼ì´ë“œ:</span>
                <span class="preview-value" id="slideCount">-</span>
            </div>
            <div class="preview-row">
                <span class="preview-label">í˜ì´ì§€ë‹¹ í‰ê·  í•­ëª©:</span>
                <span class="preview-value" id="itemsPerPage">-</span>
            </div>
        </div>

        <button id="createBtn" class="btn">ğŸ“Š PPT ìƒì„±í•˜ê¸°</button>
        
        <div id="status" class="status hidden"></div>
    </div>

    <!-- PptxGenJS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    
    <script>
        console.log('ğŸš€ í˜ì´ì§€ ë¡œë“œë¨');
        
        // ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const titleInput = document.getElementById('title');
        const pageCountInput = document.getElementById('pageCount');
        const contentTextarea = document.getElementById('content');
        const createBtn = document.getElementById('createBtn');
        const statusDiv = document.getElementById('status');
        const lineCountSpan = document.getElementById('lineCount');
        const slideCountSpan = document.getElementById('slideCount');
        const itemsPerPageSpan = document.getElementById('itemsPerPage');

        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updatePreview() {
            const content = contentTextarea.value;
            const pageCount = parseInt(pageCountInput.value) || 1;
            const lines = content.split('\n').filter(l => l.trim());
            
            lineCountSpan.textContent = lines.length + 'ê°œ';
            slideCountSpan.textContent = (pageCount + 1) + 'ì¥ (ì œëª© í¬í•¨)';
            itemsPerPageSpan.textContent = Math.ceil(lines.length / pageCount) + 'ê°œ';
        }

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function showStatus(message, type) {
            statusDiv.textContent = message;
            statusDiv.className = 'status ' + type;
        }

        function hideStatus() {
            statusDiv.className = 'status hidden';
        }

        // PPT ìƒì„±
        async function createPPT() {
            console.log('ğŸ¬ createPPT í•¨ìˆ˜ ì‹œì‘');
            
            const title = titleInput.value.trim();
            const pageCount = parseInt(pageCountInput.value) || 1;
            const content = contentTextarea.value.trim();

            if (!title) {
                alert('âŒ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            if (!content) {
                alert('âŒ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            // PptxGenJS ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
            if (typeof PptxGenJS === 'undefined') {
                alert('âŒ PPT ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                console.error('PptxGenJS is not loaded');
                return;
            }

            console.log('âœ… PptxGenJS ë¡œë“œë¨');

            // ë²„íŠ¼ ë¹„í™œì„±í™”
            createBtn.disabled = true;
            showStatus('â³ PPT ìƒì„± ì¤‘...', 'loading');

            try {
                console.log('ğŸ“¤ Creating PPT:', { title, pageCount });

                // ë‚´ìš© ë¶„í• 
                const lines = content.split('\n').filter(line => line.trim());
                const linesPerPage = Math.ceil(lines.length / pageCount);
                
                const slides = [];
                for (let i = 0; i < pageCount; i++) {
                    const startIdx = i * linesPerPage;
                    const endIdx = Math.min(startIdx + linesPerPage, lines.length);
                    const pageLines = lines.slice(startIdx, endIdx);
                    
                    if (pageLines.length > 0) {
                        slides.push({
                            title: `${title} - ${i + 1}`,
                            content: pageLines.join('\n')
                        });
                    }
                }

                console.log('ğŸ“„ Generated slides:', slides.length);

                // PPT ìƒì„±
                const pptx = new PptxGenJS();
                
                pptx.author = 'Superplace Study';
                pptx.company = 'Superplace';
                pptx.title = title;

                // ì œëª© ìŠ¬ë¼ì´ë“œ
                const titleSlide = pptx.addSlide();
                titleSlide.background = { color: 'FFFFFF' };
                titleSlide.addText(title, {
                    x: 1,
                    y: 2.5,
                    w: 8,
                    h: 1.5,
                    fontSize: 44,
                    bold: true,
                    color: '363636',
                    align: 'center'
                });
                titleSlide.addText(`ì´ ${slides.length}ê°œ ìŠ¬ë¼ì´ë“œ`, {
                    x: 1,
                    y: 4,
                    w: 8,
                    h: 0.5,
                    fontSize: 20,
                    color: '666666',
                    align: 'center'
                });

                // ë‚´ìš© ìŠ¬ë¼ì´ë“œ
                slides.forEach((slideData, index) => {
                    const slide = pptx.addSlide();
                    slide.background = { color: 'FFFFFF' };
                    
                    slide.addText(slideData.title, {
                        x: 0.5,
                        y: 0.5,
                        w: 9,
                        h: 0.8,
                        fontSize: 28,
                        bold: true,
                        color: '363636',
                        align: 'center'
                    });
                    
                    const contentLines = slideData.content.split('\n').filter(line => line.trim());
                    slide.addText(contentLines, {
                        x: 1,
                        y: 2,
                        w: 8,
                        h: 4.5,
                        fontSize: 16,
                        color: '555555',
                        align: 'left',
                        valign: 'top',
                        bullet: true
                    });
                    
                    slide.addText(`${index + 1} / ${slides.length}`, {
                        x: 8.5,
                        y: 7,
                        w: 1,
                        h: 0.3,
                        fontSize: 12,
                        color: '999999',
                        align: 'right'
                    });
                });

                console.log('âœ… PPT ê°ì²´ ìƒì„± ì™„ë£Œ');

                const filename = `${title.replace(/[^a-zA-Z0-9ê°€-í£]/g, '_')}_${Date.now()}.pptx`;

                showStatus('ğŸ“¥ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘...', 'loading');

                await pptx.writeFile({ fileName: filename });
                
                console.log('âœ… PPT íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ:', filename);
                showStatus(`âœ… PPTê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! (${filename})`, 'success');
                
                setTimeout(() => {
                    alert(`âœ… PPTê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\níŒŒì¼ëª…: ${filename}\nìŠ¬ë¼ì´ë“œ ìˆ˜: ${slides.length + 1}ê°œ (ì œëª© í¬í•¨)\n\nDownloads í´ë”ë¥¼ í™•ì¸í•˜ì„¸ìš”!`);
                }, 500);

            } catch (error) {
                console.error('âŒ Failed to create PPT:', error);
                showStatus('âŒ PPT ìƒì„± ì‹¤íŒ¨: ' + error.message, 'error');
                alert('âŒ PPT ìƒì„± ì‹¤íŒ¨:\n' + error.message);
            } finally {
                createBtn.disabled = false;
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        contentTextarea.addEventListener('input', updatePreview);
        pageCountInput.addEventListener('input', updatePreview);
        createBtn.addEventListener('click', createPPT);

        // ì´ˆê¸° ë¯¸ë¦¬ë³´ê¸°
        updatePreview();
        
        console.log('âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
    </script>
</body>
</html>
