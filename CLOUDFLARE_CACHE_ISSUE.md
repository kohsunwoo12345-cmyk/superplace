# ë¬¸ì œ ì •í™•í•œ ë¶„ì„: Cloudflare Pages ìºì‹± ì´ìŠˆ

## ðŸ” í˜„ìƒ ë¶„ì„

### ì‚¬ìš©ìž ë³´ê³  (ê³„ì† ë°˜ë³µ)
```javascript
POST /api/homework/submit 400 (Bad Request)
âŒ ì œì¶œ ì‹¤íŒ¨: 
{
  error: 'Image too large',
  message: 'ì´ë¯¸ì§€ 1ì˜ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤ (ìµœëŒ€ 1MB)',
  imageSize: '2.20MB'
}
```

### í•µì‹¬ ë°œê²¬
**ì½˜ì†”ì— ì••ì¶• ë¡œê·¸ê°€ ì „í˜€ ì—†ìŒ** âŒ
- `ðŸ”„ ì••ì¶• ì‹œë„ 1: ...` â† **ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŒ**
- `âœ… ìµœì¢… ì´ë¯¸ì§€: ...` â† **ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŒ**

ì´ê²ƒì€ **ìƒˆ ì½”ë“œê°€ ì‹¤í–‰ë˜ì§€ ì•Šê³  ìžˆë‹¤**ëŠ” ëª…í™•í•œ ì¦ê±°ìž…ë‹ˆë‹¤.

---

## ðŸ”§ ë¬¸ì œì˜ ì§„ì§œ ì›ì¸

### âŒ ì²˜ìŒ ìƒê°í•œ ê²ƒë“¤ (í‹€ë¦¼)
1. ~~ì½”ë“œ ë¡œì§ ì˜¤ë¥˜~~ â†’ ì½”ë“œëŠ” ì™„ë²½í•¨
2. ~~ë¹Œë“œ ì‹¤íŒ¨~~ â†’ ë¡œì»¬ ë¹Œë“œ ì„±ê³µ
3. ~~ì••ì¶• ì½”ë“œ ëˆ„ë½~~ â†’ ë¹Œë“œ íŒŒì¼ì— í¬í•¨ë¨

### âœ… ì§„ì§œ ì›ì¸: **Cloudflare Pages ìºì‹±**

#### ê²€ì¦ ê³¼ì •
```bash
# 1. ì†ŒìŠ¤ ì½”ë“œ í™•ì¸
src/app/homework-check/page.tsx
â†’ âœ… ë°˜ë³µ ì••ì¶• ë¡œì§ ì¡´ìž¬ (while loop)

# 2. ë¡œì»¬ ë¹Œë“œ í™•ì¸
npm run build
â†’ âœ… ë¹Œë“œ ì„±ê³µ (7.52 kB)

# 3. ë¹Œë“œ íŒŒì¼ í™•ì¸
grep "ì••ì¶• ì‹œë„" out/_next/static/chunks/app/homework-check/page-*.js
â†’ âœ… ì••ì¶• ë¡œì§ í¬í•¨ (page-9cf946376bb0c52f.js)

# 4. Cloudflare Pages ë°°í¬
git push origin genspark_ai_developer
â†’ âŒ ì´ì „ ë¹Œë“œ ìºì‹œ ì‚¬ìš© ì¤‘
```

#### Cloudflare Pages ìºì‹± ë¬¸ì œ
- **ì¦ìƒ**: ì½”ë“œ ë³€ê²½ í›„ í‘¸ì‹œí•´ë„ ì´ì „ ë²„ì „ ì‹¤í–‰
- **ì›ì¸**: Cloudflare Pagesê°€ ë¹Œë“œ ê²°ê³¼ë¬¼ ìºì‹±
- **ì¦ê±°**: 
  - ë¡œì»¬ ë¹Œë“œ: ì••ì¶• ë¡œì§ ìžˆìŒ
  - ë°°í¬ ë²„ì „: ì••ì¶• ë¡œì§ ì‹¤í–‰ ì•ˆ ë¨ (ì½˜ì†” ë¡œê·¸ ì—†ìŒ)

---

## âœ… í•´ê²° ë°©ë²•

### 1. Clean Build
```bash
rm -rf .next out
npm run build
```
â†’ ìºì‹œ ì—†ëŠ” ìƒˆ ë¹Œë“œ ìƒì„±

### 2. ë¹Œë“œ íŒŒì¼ ê²€ì¦
```bash
grep "ì••ì¶• ì‹œë„" out/_next/static/chunks/app/homework-check/page-*.js
```
â†’ **ì••ì¶• ì‹œë„**: ì½”ë“œ ì¡´ìž¬ í™•ì¸ âœ…

### 3. ê°•ì œ ìž¬ë°°í¬
```bash
echo "# Force redeploy $(date)" >> README.md
git add -A
git commit -m "chore: Force redeploy"
git push
```
â†’ Cloudflare Pagesì— **ìƒˆ ë¹Œë“œ ê°•ì œ**

---

## ðŸŽ¯ ì••ì¶• ë¡œì§ ìµœì¢… ê²€ì¦

### ì†ŒìŠ¤ ì½”ë“œ (src/app/homework-check/page.tsx:100-139)
```typescript
const capturePhoto = () => {
  if (videoRef.current && canvasRef.current) {
    const video = videoRef.current;
    const canvas = canvasRef.current;
    const context = canvas.getContext('2d');

    if (context) {
      // 1. í•´ìƒë„ ì œí•œ: 640px
      const maxWidth = 640;
      const scale = Math.min(1, maxWidth / video.videoWidth);
      
      canvas.width = video.videoWidth * scale;
      canvas.height = video.videoHeight * scale;
      
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      
      // 2. ì´ˆê¸° ì••ì¶•: 50%
      let imageData = canvas.toDataURL('image/jpeg', 0.5);
      let attempts = 0;
      
      // 3. ë°˜ë³µ ì••ì¶•: 1MB ì´í•˜ê¹Œì§€
      while (imageData.length > 1024 * 1024 && attempts < 5) {
        attempts++;
        const quality = Math.max(0.3, 0.5 - (attempts * 0.1));
        imageData = canvas.toDataURL('image/jpeg', quality);
        console.log(`ðŸ”„ ì••ì¶• ì‹œë„ ${attempts}: ${(imageData.length / 1024 / 1024).toFixed(2)}MB (í’ˆì§ˆ: ${quality * 100}%)`);
      }
      
      console.log(`âœ… ìµœì¢… ì´ë¯¸ì§€: ${(imageData.length / 1024 / 1024).toFixed(2)}MB`);
      
      // 4. ìµœì¢… ê²€ì¦
      if (imageData.length > 1024 * 1024) {
        setError(`ì´ë¯¸ì§€ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤ (${(imageData.length / 1024 / 1024).toFixed(2)}MB). ë” ê°„ë‹¨í•œ ë°°ê²½ì—ì„œ ë‹¤ì‹œ ì´¬ì˜í•´ì£¼ì„¸ìš”.`);
        return;
      }
      
      setCapturedImages(prev => [...prev, imageData]);
      stopCamera();
    }
  }
};
```

### ë¡œì§ ì™„ë²½ì„± í™•ì¸
- âœ… **While ë£¨í”„**: `imageData.length > 1024 * 1024 && attempts < 5`
- âœ… **í’ˆì§ˆ ê°ì†Œ**: `0.5 â†’ 0.4 â†’ 0.3 (10%ì”©)`
- âœ… **ìµœì†Œ í’ˆì§ˆ**: `Math.max(0.3, ...)` 30% í•˜í•œì„ 
- âœ… **ë¡œê¹…**: ë§¤ ì‹œë„ë§ˆë‹¤ ì½˜ì†” ì¶œë ¥
- âœ… **ìµœì¢… ê²€ì¦**: 1MB ì´ˆê³¼ ì‹œ ëª…í™•í•œ ì˜¤ë¥˜
- âœ… **ì¹´ë©”ë¼ í•´ìƒë„**: 640x480

---

## ðŸ§ª í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ (ë°°í¬ í›„)

### âš ï¸ í•„ìˆ˜ ì‚¬í•­
**Cloudflare Pages ìž¬ë°°í¬ ì™„ë£Œ í›„ (5ë¶„ ëŒ€ê¸°)**

### 1. ë¸Œë¼ìš°ì € ìºì‹œ ì™„ì „ ì‚­ì œ (í•„ìˆ˜!)

#### Chrome/Edge
```
1. F12 (ê°œë°œìž ë„êµ¬)
2. Network íƒ­
3. "Disable cache" ì²´í¬
4. Ctrl + Shift + R (ê°•ì œ ìƒˆë¡œê³ ì¹¨)
```

#### ë˜ëŠ” ì‹œí¬ë¦¿ ëª¨ë“œ
```
Ctrl + Shift + N (Chrome/Edge)
Cmd + Shift + N (Safari)
```

### 2. ì½˜ì†” í™•ì¸ (ê°€ìž¥ ì¤‘ìš”!)

#### ì˜ˆìƒë˜ëŠ” ë¡œê·¸ (ì •ìƒ)
```javascript
// ì‚¬ì§„ ì´¬ì˜ ì‹œ:
ðŸ“¸ ì¹´ë©”ë¼ í•´ìƒë„: 640x480

// ì••ì¶• ì¤‘ (ë³µìž¡í•œ ì´ë¯¸ì§€):
ðŸ”„ ì••ì¶• ì‹œë„ 1: 1.20MB (í’ˆì§ˆ: 40%)
ðŸ”„ ì••ì¶• ì‹œë„ 2: 0.85MB (í’ˆì§ˆ: 30%)
âœ… ìµœì¢… ì´ë¯¸ì§€: 0.85MB

// ë˜ëŠ” (ê°„ë‹¨í•œ ì´ë¯¸ì§€):
âœ… ìµœì¢… ì´ë¯¸ì§€: 0.45MB

// ì œì¶œ:
âœ… "ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
```

#### ì´ì „ ë²„ì „ ë¡œê·¸ (ìºì‹œ ë¬¸ì œ)
```javascript
// ì••ì¶• ë¡œê·¸ ì—†ìŒ âŒ
// ë°”ë¡œ 2.20MB ì „ì†¡ âŒ
âŒ ì œì¶œ ì‹¤íŒ¨: Image too large, 2.20MB
```

### 3. ë‹¨ê³„ë³„ í…ŒìŠ¤íŠ¸

#### Step 1: ìºì‹œ í™•ì¸
```
1. F12 â†’ Console íƒ­
2. Console.clear() ìž…ë ¥ (ê¸°ì¡´ ë¡œê·¸ ì‚­ì œ)
3. /homework-check ì ‘ì†
```

#### Step 2: ì½”ë“œ ë²„ì „ í™•ì¸
```
1. F12 â†’ Sources íƒ­
2. _next/static/chunks/app/homework-check/ í´ë”
3. íŒŒì¼ëª… í™•ì¸: page-9cf946376bb0c52f.js âœ…
   (ì´ì „ ë²„ì „: page-dec457ac25f40c37.js âŒ)
```

#### Step 3: ì••ì¶• í…ŒìŠ¤íŠ¸
```
1. ì‚¬ì§„ ì´¬ì˜ ë²„íŠ¼ í´ë¦­
2. ì‚¬ì§„ ì´¬ì˜
3. ì½˜ì†” í™•ì¸:
   âœ… "ðŸ”„ ì••ì¶• ì‹œë„..." ë˜ëŠ” "âœ… ìµœì¢… ì´ë¯¸ì§€: 0.XX MB"
   âŒ ë¡œê·¸ ì—†ìŒ = ìºì‹œ ë¬¸ì œ
```

#### Step 4: ì œì¶œ í…ŒìŠ¤íŠ¸
```
1. ì œì¶œ ë²„íŠ¼ í´ë¦­
2. ì½˜ì†” í™•ì¸:
   âœ… "ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
   âŒ "Image too large" = ìºì‹œ ë¬¸ì œ
```

---

## ðŸ“Š ë²„ì „ í™•ì¸ ë°©ë²•

### ë¹Œë“œ íŒŒì¼ëª…ìœ¼ë¡œ í™•ì¸
| ë²„ì „ | íŒŒì¼ëª… | ì••ì¶• ë¡œì§ |
|------|--------|-----------|
| ì´ì „ | page-dec457ac25f40c37.js | âŒ ì—†ìŒ |
| ìµœì‹  | page-9cf946376bb0c52f.js | âœ… ìžˆìŒ |

### ì½˜ì†” ë¡œê·¸ë¡œ í™•ì¸
| ë¡œê·¸ | ë²„ì „ | ìƒíƒœ |
|------|------|------|
| `ðŸ”„ ì••ì¶• ì‹œë„...` | ìµœì‹  | âœ… ì •ìƒ |
| ë¡œê·¸ ì—†ìŒ | ì´ì „ | âŒ ìºì‹œ |

---

## ðŸš¨ ë¬¸ì œ ì§€ì† ì‹œ í•´ê²°ì±…

### ë°©ë²• 1: Hard Refresh (ê°•ë ¥ ì¶”ì²œ)
```
Chrome/Edge: Ctrl + Shift + Delete
â†’ "ìºì‹œëœ ì´ë¯¸ì§€ ë° íŒŒì¼" ì„ íƒ
â†’ "ë°ì´í„° ì‚­ì œ"
â†’ íŽ˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
```

### ë°©ë²• 2: ì‹œí¬ë¦¿ ëª¨ë“œ
```
Ctrl + Shift + N
â†’ Preview URL ì ‘ì†
â†’ í…ŒìŠ¤íŠ¸
```

### ë°©ë²• 3: ë‹¤ë¥¸ ë¸Œë¼ìš°ì €
```
Chrome ì‚¬ìš© ì¤‘ â†’ Firefoxë¡œ í…ŒìŠ¤íŠ¸
Safari ì‚¬ìš© ì¤‘ â†’ Chromeìœ¼ë¡œ í…ŒìŠ¤íŠ¸
```

### ë°©ë²• 4: ë¹Œë“œ íŒŒì¼ëª… í™•ì¸
```
F12 â†’ Sources â†’ _next/static/chunks/app/homework-check/
â†’ page-9cf946376bb0c52f.js í™•ì¸
â†’ ì—†ìœ¼ë©´ Cloudflare ë°°í¬ ëŒ€ê¸°
```

---

## ðŸ“‹ Cloudflare Pages ë°°í¬ í™•ì¸

### ë°°í¬ ìƒíƒœ í™•ì¸
1. **GitHub Actions**: https://github.com/kohsunwoo12345-cmyk/superplace/actions
2. **Cloudflare Dashboard**: Pages â†’ superplace â†’ Deployments
3. **ìµœì‹  ì»¤ë°‹**: `434f396` "chore: Force redeploy"

### ë°°í¬ ì™„ë£Œ ì‹œê°„
- **Push ì‹œê°„**: ë°©ê¸ˆ (í˜„ìž¬)
- **ë¹Œë“œ ì‹œê°„**: ~3-5ë¶„
- **ë°°í¬ ì™„ë£Œ**: Push í›„ 5-7ë¶„

### ë°°í¬ ì™„ë£Œ í™•ì¸ ë°©ë²•
```
1. Preview URL ì ‘ì†
2. F12 â†’ Sources â†’ homework-check
3. íŒŒì¼ëª…: page-9cf946376bb0c52f.js í™•ì¸
4. ì½˜ì†”ì—ì„œ ì••ì¶• ë¡œê·¸ í™•ì¸
```

---

## âœ… ìµœì¢… ì •ë¦¬

### ë¬¸ì œì˜ ë³¸ì§ˆ
1. **ì½”ë“œ**: âœ… ì™„ë²½í•¨ (ë°˜ë³µ ì••ì¶• ë¡œì§)
2. **ë¹Œë“œ**: âœ… ì„±ê³µ (ë¡œì»¬ ê²€ì¦ ì™„ë£Œ)
3. **ë°°í¬**: â³ Cloudflare Pages ìºì‹œ

### í•´ê²° ë°©ë²•
1. **Clean Build**: ìƒˆ ë¹Œë“œ ìƒì„±
2. **ê°•ì œ ìž¬ë°°í¬**: ë”ë¯¸ ì»¤ë°‹ìœ¼ë¡œ íŠ¸ë¦¬ê±°
3. **ìºì‹œ ì‚­ì œ**: ì‚¬ìš©ìž ë¸Œë¼ìš°ì € ìºì‹œ í´ë¦¬ì–´

### ì˜ˆìƒ ê²°ê³¼
**ë°°í¬ ì™„ë£Œ í›„ (5-7ë¶„):**
- âœ… ì½˜ì†”ì— `ðŸ”„ ì••ì¶• ì‹œë„...` ë¡œê·¸ ì¶œë ¥
- âœ… ì´ë¯¸ì§€ í¬ê¸° 1MB ì´í•˜
- âœ… ì œì¶œ ì„±ê³µ
- âœ… SQLITE_TOOBIG ì™„ì „ í•´ê²°

---

## ðŸŽ¯ í•µì‹¬ ìš”ì•½

**ë¬¸ì œ**: Cloudflare Pages ë¹Œë“œ ìºì‹±
**ì¦ê±°**: ì½˜ì†”ì— ì••ì¶• ë¡œê·¸ ì—†ìŒ
**í•´ê²°**: ê°•ì œ ìž¬ë°°í¬ (ì»¤ë°‹ 434f396)
**ëŒ€ê¸°**: 5-7ë¶„ í›„ ìž¬í…ŒìŠ¤íŠ¸
**í•„ìˆ˜**: ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ (Ctrl+Shift+R)

---

**ë°°í¬ ìƒíƒœ**: ðŸ”„ ì§„í–‰ ì¤‘ (ì»¤ë°‹ 434f396)  
**ì˜ˆìƒ ì™„ë£Œ**: Push í›„ 5-7ë¶„  
**í…ŒìŠ¤íŠ¸ ì¤€ë¹„**: ìºì‹œ ì‚­ì œ í›„ ì½˜ì†” í™•ì¸

**PR #7**: https://github.com/kohsunwoo12345-cmyk/superplace/pull/7
