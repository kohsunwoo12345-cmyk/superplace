# 출결 관리 및 AI 대화 내역 테스트 계획

## 배포 정보
- **커밋**: 3169923
- **배포 URL**: https://superplacestudy.pages.dev
- **배포 대기**: 2-3분

---

## 1. 출결 통계 표시 테스트

### 1.1 기본 표시 테스트
**목적**: 출결 통계가 항상 표시되는지 확인

**테스트 단계**:
1. 학생 상세 페이지 접속 (예: ID 246)
2. "출결" 탭 클릭
3. 다음 항목들이 표시되는지 확인:
   - ✅ 총 출결: N일
   - ✅ 출석: N일 (초록색)
   - ✅ 지각: N일 (노란색)
   - ✅ 결석: N일 (빨간색)
   - ✅ 출석률: N% (파란색)

**예상 결과**:
- 출결 기록이 없는 경우: 모든 값이 "0"으로 표시
- 출결 기록이 있는 경우: 실제 값 표시

---

### 1.2 출결 기록이 있는 경우
**테스트 데이터**:
```
출석: 18일
지각: 2일  
결석: 1일
총 출결: 21일
출석률: 95.2% (계산: (18+2)/21 * 100)
```

**확인 사항**:
- [ ] 각 숫자가 정확히 표시됨
- [ ] 색상이 올바르게 적용됨
- [ ] 출석률 계산이 정확함

---

### 1.3 출결 기록 목록
**표시 항목**:
- 날짜
- 상태 (출석/지각/결석)
- 체크인 시간
- 체크아웃 시간
- 메모

**확인 사항**:
- [ ] 날짜순 정렬 (최신순)
- [ ] 상태별 뱃지 색상 (출석=초록, 지각=노랑, 결석=빨강)
- [ ] 빈 데이터 처리: "출결 기록이 없습니다" 메시지

---

## 2. AI 챗봇 대화 내역 테스트

### 2.1 대화 내역 표시
**목적**: AI 챗봇 대화 내역이 올바르게 표시되는지 확인

**테스트 단계**:
1. 학생 상세 페이지 접속
2. "AI 대화" 탭 클릭
3. 대화 내역 확인

**예상 결과**:
- 대화가 없는 경우: "아직 대화 내역이 없습니다" 메시지
- 대화가 있는 경우: 채팅 형태로 표시

---

### 2.2 대화 형식 확인
**표시 형식**:
```
[사용자 메시지]
  오른쪽 정렬
  파란색 배경
  흰색 텍스트
  타임스탬프

[AI 메시지]  
  왼쪽 정렬
  회색 배경
  검은색 텍스트
  타임스탬프
```

**확인 사항**:
- [ ] 메시지가 역할(user/AI)에 따라 올바르게 정렬됨
- [ ] 색상이 정확히 적용됨
- [ ] 타임스탬프가 한국 시간으로 표시됨
- [ ] 긴 메시지가 줄바꿈 처리됨
- [ ] 스크롤이 작동함 (최대 높이 500px)

---

### 2.3 대화 개수 표시
**위치**: 카드 헤더의 CardDescription

**표시 형식**: "총 N개의 대화가 있습니다"

**확인 사항**:
- [ ] 실제 대화 개수와 일치
- [ ] 새로고침 시 업데이트됨

---

## 3. API 테스트

### 3.1 출결 API 테스트
```bash
curl "https://superplacestudy.pages.dev/api/students/attendance?studentId=246" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**예상 응답**:
```json
{
  "success": true,
  "attendance": [...],
  "stats": {
    "total": 0,
    "present": 0,
    "late": 0,
    "absent": 0,
    "excused": 0,
    "attendanceRate": 0
  }
}
```

---

### 3.2 채팅 내역 API 테스트
```bash
curl "https://superplacestudy.pages.dev/api/students/chat-history?studentId=246" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**예상 응답**:
```json
{
  "success": true,
  "chatHistory": [],
  "count": 0
}
```

---

## 4. 다중 테이블명 패턴 테스트

### 4.1 출결 테이블
**시도 순서**:
1. `attendance` (snake_case) ← 우선
2. `Attendance` (PascalCase) ← 백업

---

### 4.2 채팅 테이블
**시도 순서**:
1. `chat_messages` (snake_case) ← 우선
2. `ChatHistory` (PascalCase) ← 백업
3. `ai_chat_history` (snake_case) ← 최종 백업

---

## 5. 에러 처리 테스트

### 5.1 테이블이 없는 경우
**예상 동작**:
- API는 빈 배열 반환 (`[]`)
- UI는 "데이터 없음" 메시지 표시
- 에러가 발생하지 않음

---

### 5.2 네트워크 오류
**예상 동작**:
- 콘솔에 경고 로그
- UI는 이전 상태 유지 또는 빈 상태 표시

---

## 6. 종합 체크리스트

### 출결 관리
- [ ] 총 출결 표시
- [ ] 출석 표시 (초록색)
- [ ] 지각 표시 (노란색)
- [ ] 결석 표시 (빨간색)
- [ ] 출석률 표시 (파란색)
- [ ] 출결 기록 목록 표시
- [ ] 빈 데이터 처리
- [ ] 새로고침 버튼 작동

### AI 대화
- [ ] 대화 내역 표시
- [ ] 사용자 메시지 형식 (오른쪽, 파란색)
- [ ] AI 메시지 형식 (왼쪽, 회색)
- [ ] 타임스탬프 표시
- [ ] 대화 개수 표시
- [ ] 스크롤 작동
- [ ] 빈 데이터 처리
- [ ] 새로고침 버튼 작동

---

## 7. 배포 후 확인 절차

1. **3분 대기** (Cloudflare Pages 배포 완료)

2. **브라우저 캐시 클리어**:
   - Chrome/Edge: Ctrl+Shift+R (Windows) / Cmd+Shift+R (Mac)
   - Firefox: Ctrl+F5 (Windows) / Cmd+Shift+R (Mac)
   - Safari: Cmd+Option+E, 그 다음 Cmd+R

3. **개발자 도구 확인**:
   - F12 → Network 탭 → "Disable cache" 체크
   - Console 탭 → API 호출 로그 확인

4. **테스트 실행**:
   - 학생 246 상세 페이지 접속
   - 출결 탭 확인
   - AI 대화 탭 확인
   - 새로고침 버튼 클릭
   - 각 데이터 표시 확인

---

## 8. 알려진 제한사항

1. **데이터베이스 테이블**:
   - 실제 테이블이 생성되어 있어야 데이터 표시 가능
   - 테이블이 없으면 0 또는 빈 상태로 표시

2. **인증**:
   - 유효한 토큰이 필요
   - 토큰 없이는 API 호출 불가

3. **출석률 계산**:
   - 출석 + 지각을 출석으로 계산
   - 결석과 무단결석은 제외

---

## 9. 예상 문제 및 해결

### 문제: "미등록" 또는 빈 데이터만 표시됨
**원인**: 테이블에 데이터가 없음
**해결**: 
1. 출결 데이터 입력
2. AI 챗봇 사용하여 대화 생성

### 문제: API 호출 실패 (401 Unauthorized)
**원인**: 인증 토큰 만료
**해결**: 
1. 로그아웃 후 재로그인
2. 새 토큰 발급

### 문제: 데이터가 업데이트되지 않음
**원인**: 브라우저 캐시
**해결**:
1. 강력한 새로고침 (Ctrl+Shift+R)
2. 개발자 도구에서 "Disable cache" 활성화

---

## 완료! ✅

모든 항목이 체크되면 출결 관리 및 AI 대화 내역 기능이 정상 작동하는 것입니다.
